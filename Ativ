create table clientes(
id serial primary key,
nome varchar(50) not null
);

create table telefones(
id serial primary key,
cliente_id int,
telefone char(9) not null,
foreign key (cliente_id) references clientes(id)
);

create table categorias(
id serial primary key,
categoria varchar(50)
);

create table produtos(
id serial primary key,
produto varchar(50)not null,
preco numeric(9,2)not null,
id_categorias int,
foreign key(id_categorias) references categorias(id)
);

create table vendas(
id serial primary key,
total numeric(10,0) not null,
id_produtos int,
foreign key (id_produtos) references produtos(id)
);
create table vendas_produtos(
id serial primary key,
id_produtos int,
id_vendas int,
foreign key (id_produtos) references produtos(id),
foreign key (id_vendas) references vendas(id)
);

insert into clientes  (nome)
values('roberto'),('miguel'),('matheus');

insert into telefones  (cliente_id,telefone)
values(1,'981209876'),(2,'980322403'),(3,'981130323');

insert into categorias (categoria)
values('Papelaria'),('Informatica'),('Alimentação');

insert into produtos (produto,preco,id_categorias)
values('Caneta',1.50,(select id from categorias where categoria = 'Papelaria')),
('Mouse',14.50,(select id from categorias where categoria = 'Informatica')),
('Biscoito',4.50,(select id from categorias where categoria = 'Alimentação'));

update produtos 
set preco = preco * 1.3
where id_categorias=(select id from categorias where categoria='papelaria');

alter table  vendas add column cliente_id int;
alter table vendas add foreign key (cliente_id) references clientes(id);


insert into vendas(total,id_produtos,cliente_id)
values ((select preco from produtos  where id = 1),1,2);

insert into vendas(total,id_produtos,cliente_id)
values ((select preco from produtos  where id = 1),2,1);

insert into vendas(total,id_produtos,cliente_id)
values ((select preco from produtos  where id = 2),3,3);

select c.nome ,t.telefone
from clientes c
left join telefones t
on c.id = t.cliente_id;
